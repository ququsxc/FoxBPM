<?xml version="1.0" encoding="UTF-8" ?>    
<!DOCTYPE mapper    
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN"    
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">  
  
<mapper namespace="com.zf.dao.AttachmentDao">  
	
    <insert id="save" parameterType="Attachment">
    	insert into tb_attachment values(#{id},#{originalName},#{contentType},#{absolutePath},#{relativePath},#{size},sysdate(),null)
    </insert>
    
    <delete id="remove" parameterType="String">
    	delete from tb_attachment where id=#{id}
    </delete>
    
    <select id="get" parameterType="String" resultType="Attachment">
    	select * from tb_attachment where id=#{id}
    </select>
    
    <update id="updateToken" parameterType="Map">
    	<foreach collection="_parameter.keys" item="k" separator=";">  
	    	update tb_attachment set token=#{k}   
	        where id in     
	        <foreach collection="_parameter[k]" index="index" item="item" open="(" separator="," close=")">    
	            #{item}    
	        </foreach>  
		</foreach>
    </update>
    
    <select id="findByToken" parameterType="String" resultType="Attachment">
    	select id,original_name,content_type,size,create_time,token from tb_attachment where token=#{token}
    </select>
</mapper> 